{"ast":null,"code":"// Google Custom Search API Service\n// Fetches real images from Google search results based on address\n\nclass GoogleSearchService {\n  constructor() {\n    this.apiKey = process.env.REACT_APP_GOOGLE_SEARCH_API_KEY;\n    this.searchEngineId = process.env.REACT_APP_GOOGLE_SEARCH_ENGINE_ID;\n    this.baseUrl = 'https://www.googleapis.com/customsearch/v1';\n  }\n\n  // Check if service is properly configured\n  isConfigured() {\n    return this.apiKey && this.searchEngineId;\n  }\n\n  // Get configuration status\n  getConfigStatus() {\n    return {\n      hasApiKey: !!this.apiKey,\n      hasSearchEngineId: !!this.searchEngineId,\n      isConfigured: this.isConfigured()\n    };\n  }\n\n  // Search for images using Google Custom Search\n  async searchImages(query, count = 5) {\n    if (!this.isConfigured()) {\n      console.warn('Google Search API not configured. Please set REACT_APP_GOOGLE_SEARCH_API_KEY and REACT_APP_GOOGLE_SEARCH_ENGINE_ID');\n      return null;\n    }\n    try {\n      const searchUrl = `${this.baseUrl}?key=${this.apiKey}&cx=${this.searchEngineId}&q=${encodeURIComponent(query)}&searchType=image&num=${count}&safe=active`;\n      console.log('Searching Google for:', query);\n      const response = await fetch(searchUrl);\n      if (!response.ok) {\n        throw new Error(`Google Search API error: ${response.status} ${response.statusText}`);\n      }\n      const data = await response.json();\n      if (data.items && data.items.length > 0) {\n        const images = data.items.map(item => {\n          var _item$image, _item$image2;\n          return {\n            url: item.link,\n            thumbnail: (_item$image = item.image) === null || _item$image === void 0 ? void 0 : _item$image.thumbnailLink,\n            title: item.title,\n            context: (_item$image2 = item.image) === null || _item$image2 === void 0 ? void 0 : _item$image2.contextLink\n          };\n        });\n        console.log(`Found ${images.length} images for query: ${query}`);\n        return images;\n      }\n      console.log(`No images found for query: ${query}`);\n      return null;\n    } catch (error) {\n      console.error('Google Search API error:', error);\n      return null;\n    }\n  }\n\n  // Get the best image for a property address\n  async getPropertyImage(address, propertyType = '') {\n    try {\n      // Create multiple search queries for better results\n      const queries = [`${propertyType} ${address} building`,\n      // \"Industrial Property 123 Jurong East Ave 1 building\"\n      `${address} property building`,\n      // \"123 Jurong East Ave 1 property building\"\n      `${propertyType} ${address}`,\n      // \"Industrial Property 123 Jurong East Ave 1\"\n      `${address} Singapore`,\n      // \"123 Jurong East Ave 1 Singapore\"\n      `${propertyType} Singapore industrial` // \"Industrial Property Singapore industrial\"\n      ];\n\n      // Try each query until we find images\n      for (const query of queries) {\n        console.log(`Trying query: ${query}`);\n        const images = await this.searchImages(query, 3);\n        if (images && images.length > 0) {\n          // Return the first (best) image\n          const bestImage = images[0];\n          console.log(`Found image for ${address}:`, bestImage.url);\n          return bestImage.url;\n        }\n      }\n      console.log(`No images found for any query for address: ${address}`);\n      return null;\n    } catch (error) {\n      console.error('Error getting property image:', error);\n      return null;\n    }\n  }\n\n  // Get comparison image for two addresses\n  async getComparisonImage(address1, address2) {\n    try {\n      var _images$;\n      // Try to get image for first address\n      let imageUrl = await this.getPropertyImage(address1);\n      if (imageUrl) {\n        return imageUrl;\n      }\n\n      // Fallback to second address\n      imageUrl = await this.getPropertyImage(address2);\n      if (imageUrl) {\n        return imageUrl;\n      }\n\n      // Final fallback to generic search\n      const images = await this.searchImages('Singapore industrial property building', 1);\n      return (images === null || images === void 0 ? void 0 : (_images$ = images[0]) === null || _images$ === void 0 ? void 0 : _images$.url) || null;\n    } catch (error) {\n      console.error('Error getting comparison image:', error);\n      return null;\n    }\n  }\n\n  // Get multiple images for a property (for galleries)\n  async getPropertyImages(address, propertyType = '', count = 5) {\n    try {\n      const query = `${propertyType} ${address} building`;\n      return await this.searchImages(query, count);\n    } catch (error) {\n      console.error('Error getting property images:', error);\n      return null;\n    }\n  }\n\n  // Test the service\n  async test() {\n    try {\n      console.log('Testing Google Search Service...');\n      const configStatus = this.getConfigStatus();\n      console.log('Configuration status:', configStatus);\n      if (!this.isConfigured()) {\n        console.warn('Service not configured - cannot test');\n        return false;\n      }\n      const testResult = await this.searchImages('Singapore industrial building', 1);\n      if (testResult && testResult.length > 0) {\n        console.log('✅ Google Search Service test successful:', testResult[0].url);\n        return true;\n      } else {\n        console.log('❌ Google Search Service test failed - no results');\n        return false;\n      }\n    } catch (error) {\n      console.error('❌ Google Search Service test failed:', error);\n      return false;\n    }\n  }\n}\nexport default GoogleSearchService;","map":{"version":3,"names":["GoogleSearchService","constructor","apiKey","process","env","REACT_APP_GOOGLE_SEARCH_API_KEY","searchEngineId","REACT_APP_GOOGLE_SEARCH_ENGINE_ID","baseUrl","isConfigured","getConfigStatus","hasApiKey","hasSearchEngineId","searchImages","query","count","console","warn","searchUrl","encodeURIComponent","log","response","fetch","ok","Error","status","statusText","data","json","items","length","images","map","item","_item$image","_item$image2","url","link","thumbnail","image","thumbnailLink","title","context","contextLink","error","getPropertyImage","address","propertyType","queries","bestImage","getComparisonImage","address1","address2","_images$","imageUrl","getPropertyImages","test","configStatus","testResult"],"sources":["C:/Users/mandy/Downloads/fyp-app/fyp-app/frontend/src/services/googleSearch.js"],"sourcesContent":["// Google Custom Search API Service\r\n// Fetches real images from Google search results based on address\r\n\r\nclass GoogleSearchService {\r\n  constructor() {\r\n    this.apiKey = process.env.REACT_APP_GOOGLE_SEARCH_API_KEY;\r\n    this.searchEngineId = process.env.REACT_APP_GOOGLE_SEARCH_ENGINE_ID;\r\n    this.baseUrl = 'https://www.googleapis.com/customsearch/v1';\r\n  }\r\n\r\n  // Check if service is properly configured\r\n  isConfigured() {\r\n    return this.apiKey && this.searchEngineId;\r\n  }\r\n\r\n  // Get configuration status\r\n  getConfigStatus() {\r\n    return {\r\n      hasApiKey: !!this.apiKey,\r\n      hasSearchEngineId: !!this.searchEngineId,\r\n      isConfigured: this.isConfigured()\r\n    };\r\n  }\r\n\r\n  // Search for images using Google Custom Search\r\n  async searchImages(query, count = 5) {\r\n    if (!this.isConfigured()) {\r\n      console.warn('Google Search API not configured. Please set REACT_APP_GOOGLE_SEARCH_API_KEY and REACT_APP_GOOGLE_SEARCH_ENGINE_ID');\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const searchUrl = `${this.baseUrl}?key=${this.apiKey}&cx=${this.searchEngineId}&q=${encodeURIComponent(query)}&searchType=image&num=${count}&safe=active`;\r\n      \r\n      console.log('Searching Google for:', query);\r\n      const response = await fetch(searchUrl);\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`Google Search API error: ${response.status} ${response.statusText}`);\r\n      }\r\n      \r\n      const data = await response.json();\r\n      \r\n      if (data.items && data.items.length > 0) {\r\n        const images = data.items.map(item => ({\r\n          url: item.link,\r\n          thumbnail: item.image?.thumbnailLink,\r\n          title: item.title,\r\n          context: item.image?.contextLink\r\n        }));\r\n        \r\n        console.log(`Found ${images.length} images for query: ${query}`);\r\n        return images;\r\n      }\r\n      \r\n      console.log(`No images found for query: ${query}`);\r\n      return null;\r\n      \r\n    } catch (error) {\r\n      console.error('Google Search API error:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Get the best image for a property address\r\n  async getPropertyImage(address, propertyType = '') {\r\n    try {\r\n      // Create multiple search queries for better results\r\n      const queries = [\r\n        `${propertyType} ${address} building`,           // \"Industrial Property 123 Jurong East Ave 1 building\"\r\n        `${address} property building`,                  // \"123 Jurong East Ave 1 property building\"\r\n        `${propertyType} ${address}`,                    // \"Industrial Property 123 Jurong East Ave 1\"\r\n        `${address} Singapore`,                          // \"123 Jurong East Ave 1 Singapore\"\r\n        `${propertyType} Singapore industrial`,          // \"Industrial Property Singapore industrial\"\r\n      ];\r\n\r\n      // Try each query until we find images\r\n      for (const query of queries) {\r\n        console.log(`Trying query: ${query}`);\r\n        const images = await this.searchImages(query, 3);\r\n        \r\n        if (images && images.length > 0) {\r\n          // Return the first (best) image\r\n          const bestImage = images[0];\r\n          console.log(`Found image for ${address}:`, bestImage.url);\r\n          return bestImage.url;\r\n        }\r\n      }\r\n      \r\n      console.log(`No images found for any query for address: ${address}`);\r\n      return null;\r\n      \r\n    } catch (error) {\r\n      console.error('Error getting property image:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Get comparison image for two addresses\r\n  async getComparisonImage(address1, address2) {\r\n    try {\r\n      // Try to get image for first address\r\n      let imageUrl = await this.getPropertyImage(address1);\r\n      if (imageUrl) {\r\n        return imageUrl;\r\n      }\r\n      \r\n      // Fallback to second address\r\n      imageUrl = await this.getPropertyImage(address2);\r\n      if (imageUrl) {\r\n        return imageUrl;\r\n      }\r\n      \r\n      // Final fallback to generic search\r\n      const images = await this.searchImages('Singapore industrial property building', 1);\r\n      return images?.[0]?.url || null;\r\n      \r\n    } catch (error) {\r\n      console.error('Error getting comparison image:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Get multiple images for a property (for galleries)\r\n  async getPropertyImages(address, propertyType = '', count = 5) {\r\n    try {\r\n      const query = `${propertyType} ${address} building`;\r\n      return await this.searchImages(query, count);\r\n    } catch (error) {\r\n      console.error('Error getting property images:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Test the service\r\n  async test() {\r\n    try {\r\n      console.log('Testing Google Search Service...');\r\n      const configStatus = this.getConfigStatus();\r\n      console.log('Configuration status:', configStatus);\r\n      \r\n      if (!this.isConfigured()) {\r\n        console.warn('Service not configured - cannot test');\r\n        return false;\r\n      }\r\n      \r\n      const testResult = await this.searchImages('Singapore industrial building', 1);\r\n      if (testResult && testResult.length > 0) {\r\n        console.log('✅ Google Search Service test successful:', testResult[0].url);\r\n        return true;\r\n      } else {\r\n        console.log('❌ Google Search Service test failed - no results');\r\n        return false;\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('❌ Google Search Service test failed:', error);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\nexport default GoogleSearchService;\r\n"],"mappings":"AAAA;AACA;;AAEA,MAAMA,mBAAmB,CAAC;EACxBC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACC,MAAM,GAAGC,OAAO,CAACC,GAAG,CAACC,+BAA+B;IACzD,IAAI,CAACC,cAAc,GAAGH,OAAO,CAACC,GAAG,CAACG,iCAAiC;IACnE,IAAI,CAACC,OAAO,GAAG,4CAA4C;EAC7D;;EAEA;EACAC,YAAYA,CAAA,EAAG;IACb,OAAO,IAAI,CAACP,MAAM,IAAI,IAAI,CAACI,cAAc;EAC3C;;EAEA;EACAI,eAAeA,CAAA,EAAG;IAChB,OAAO;MACLC,SAAS,EAAE,CAAC,CAAC,IAAI,CAACT,MAAM;MACxBU,iBAAiB,EAAE,CAAC,CAAC,IAAI,CAACN,cAAc;MACxCG,YAAY,EAAE,IAAI,CAACA,YAAY,CAAC;IAClC,CAAC;EACH;;EAEA;EACA,MAAMI,YAAYA,CAACC,KAAK,EAAEC,KAAK,GAAG,CAAC,EAAE;IACnC,IAAI,CAAC,IAAI,CAACN,YAAY,CAAC,CAAC,EAAE;MACxBO,OAAO,CAACC,IAAI,CAAC,oHAAoH,CAAC;MAClI,OAAO,IAAI;IACb;IAEA,IAAI;MACF,MAAMC,SAAS,GAAG,GAAG,IAAI,CAACV,OAAO,QAAQ,IAAI,CAACN,MAAM,OAAO,IAAI,CAACI,cAAc,MAAMa,kBAAkB,CAACL,KAAK,CAAC,yBAAyBC,KAAK,cAAc;MAEzJC,OAAO,CAACI,GAAG,CAAC,uBAAuB,EAAEN,KAAK,CAAC;MAC3C,MAAMO,QAAQ,GAAG,MAAMC,KAAK,CAACJ,SAAS,CAAC;MAEvC,IAAI,CAACG,QAAQ,CAACE,EAAE,EAAE;QAChB,MAAM,IAAIC,KAAK,CAAC,4BAA4BH,QAAQ,CAACI,MAAM,IAAIJ,QAAQ,CAACK,UAAU,EAAE,CAAC;MACvF;MAEA,MAAMC,IAAI,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;MAElC,IAAID,IAAI,CAACE,KAAK,IAAIF,IAAI,CAACE,KAAK,CAACC,MAAM,GAAG,CAAC,EAAE;QACvC,MAAMC,MAAM,GAAGJ,IAAI,CAACE,KAAK,CAACG,GAAG,CAACC,IAAI;UAAA,IAAAC,WAAA,EAAAC,YAAA;UAAA,OAAK;YACrCC,GAAG,EAAEH,IAAI,CAACI,IAAI;YACdC,SAAS,GAAAJ,WAAA,GAAED,IAAI,CAACM,KAAK,cAAAL,WAAA,uBAAVA,WAAA,CAAYM,aAAa;YACpCC,KAAK,EAAER,IAAI,CAACQ,KAAK;YACjBC,OAAO,GAAAP,YAAA,GAAEF,IAAI,CAACM,KAAK,cAAAJ,YAAA,uBAAVA,YAAA,CAAYQ;UACvB,CAAC;QAAA,CAAC,CAAC;QAEH3B,OAAO,CAACI,GAAG,CAAC,SAASW,MAAM,CAACD,MAAM,sBAAsBhB,KAAK,EAAE,CAAC;QAChE,OAAOiB,MAAM;MACf;MAEAf,OAAO,CAACI,GAAG,CAAC,8BAA8BN,KAAK,EAAE,CAAC;MAClD,OAAO,IAAI;IAEb,CAAC,CAAC,OAAO8B,KAAK,EAAE;MACd5B,OAAO,CAAC4B,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAChD,OAAO,IAAI;IACb;EACF;;EAEA;EACA,MAAMC,gBAAgBA,CAACC,OAAO,EAAEC,YAAY,GAAG,EAAE,EAAE;IACjD,IAAI;MACF;MACA,MAAMC,OAAO,GAAG,CACd,GAAGD,YAAY,IAAID,OAAO,WAAW;MAAY;MACjD,GAAGA,OAAO,oBAAoB;MAAmB;MACjD,GAAGC,YAAY,IAAID,OAAO,EAAE;MAAqB;MACjD,GAAGA,OAAO,YAAY;MAA2B;MACjD,GAAGC,YAAY,uBAAuB,CAAW;MAAA,CAClD;;MAED;MACA,KAAK,MAAMjC,KAAK,IAAIkC,OAAO,EAAE;QAC3BhC,OAAO,CAACI,GAAG,CAAC,iBAAiBN,KAAK,EAAE,CAAC;QACrC,MAAMiB,MAAM,GAAG,MAAM,IAAI,CAAClB,YAAY,CAACC,KAAK,EAAE,CAAC,CAAC;QAEhD,IAAIiB,MAAM,IAAIA,MAAM,CAACD,MAAM,GAAG,CAAC,EAAE;UAC/B;UACA,MAAMmB,SAAS,GAAGlB,MAAM,CAAC,CAAC,CAAC;UAC3Bf,OAAO,CAACI,GAAG,CAAC,mBAAmB0B,OAAO,GAAG,EAAEG,SAAS,CAACb,GAAG,CAAC;UACzD,OAAOa,SAAS,CAACb,GAAG;QACtB;MACF;MAEApB,OAAO,CAACI,GAAG,CAAC,8CAA8C0B,OAAO,EAAE,CAAC;MACpE,OAAO,IAAI;IAEb,CAAC,CAAC,OAAOF,KAAK,EAAE;MACd5B,OAAO,CAAC4B,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MACrD,OAAO,IAAI;IACb;EACF;;EAEA;EACA,MAAMM,kBAAkBA,CAACC,QAAQ,EAAEC,QAAQ,EAAE;IAC3C,IAAI;MAAA,IAAAC,QAAA;MACF;MACA,IAAIC,QAAQ,GAAG,MAAM,IAAI,CAACT,gBAAgB,CAACM,QAAQ,CAAC;MACpD,IAAIG,QAAQ,EAAE;QACZ,OAAOA,QAAQ;MACjB;;MAEA;MACAA,QAAQ,GAAG,MAAM,IAAI,CAACT,gBAAgB,CAACO,QAAQ,CAAC;MAChD,IAAIE,QAAQ,EAAE;QACZ,OAAOA,QAAQ;MACjB;;MAEA;MACA,MAAMvB,MAAM,GAAG,MAAM,IAAI,CAAClB,YAAY,CAAC,wCAAwC,EAAE,CAAC,CAAC;MACnF,OAAO,CAAAkB,MAAM,aAANA,MAAM,wBAAAsB,QAAA,GAANtB,MAAM,CAAG,CAAC,CAAC,cAAAsB,QAAA,uBAAXA,QAAA,CAAajB,GAAG,KAAI,IAAI;IAEjC,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACd5B,OAAO,CAAC4B,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;MACvD,OAAO,IAAI;IACb;EACF;;EAEA;EACA,MAAMW,iBAAiBA,CAACT,OAAO,EAAEC,YAAY,GAAG,EAAE,EAAEhC,KAAK,GAAG,CAAC,EAAE;IAC7D,IAAI;MACF,MAAMD,KAAK,GAAG,GAAGiC,YAAY,IAAID,OAAO,WAAW;MACnD,OAAO,MAAM,IAAI,CAACjC,YAAY,CAACC,KAAK,EAAEC,KAAK,CAAC;IAC9C,CAAC,CAAC,OAAO6B,KAAK,EAAE;MACd5B,OAAO,CAAC4B,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACtD,OAAO,IAAI;IACb;EACF;;EAEA;EACA,MAAMY,IAAIA,CAAA,EAAG;IACX,IAAI;MACFxC,OAAO,CAACI,GAAG,CAAC,kCAAkC,CAAC;MAC/C,MAAMqC,YAAY,GAAG,IAAI,CAAC/C,eAAe,CAAC,CAAC;MAC3CM,OAAO,CAACI,GAAG,CAAC,uBAAuB,EAAEqC,YAAY,CAAC;MAElD,IAAI,CAAC,IAAI,CAAChD,YAAY,CAAC,CAAC,EAAE;QACxBO,OAAO,CAACC,IAAI,CAAC,sCAAsC,CAAC;QACpD,OAAO,KAAK;MACd;MAEA,MAAMyC,UAAU,GAAG,MAAM,IAAI,CAAC7C,YAAY,CAAC,+BAA+B,EAAE,CAAC,CAAC;MAC9E,IAAI6C,UAAU,IAAIA,UAAU,CAAC5B,MAAM,GAAG,CAAC,EAAE;QACvCd,OAAO,CAACI,GAAG,CAAC,0CAA0C,EAAEsC,UAAU,CAAC,CAAC,CAAC,CAACtB,GAAG,CAAC;QAC1E,OAAO,IAAI;MACb,CAAC,MAAM;QACLpB,OAAO,CAACI,GAAG,CAAC,kDAAkD,CAAC;QAC/D,OAAO,KAAK;MACd;IAEF,CAAC,CAAC,OAAOwB,KAAK,EAAE;MACd5B,OAAO,CAAC4B,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;MAC5D,OAAO,KAAK;IACd;EACF;AACF;AAEA,eAAe5C,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}